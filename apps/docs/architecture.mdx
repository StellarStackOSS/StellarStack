---
title: 'Architecture'
description: 'System architecture and technical design'
icon: 'sitemap'
---

# System Architecture

StellarStack follows a modern microservices architecture with a monorepo structure.

## High-Level Overview

The system consists of three main components:

1. **Web Panel** - User interface for managing servers
2. **API Server** - Backend API for all operations
3. **Daemon Nodes** - Rust services running on compute nodes

## Technology Stack

### Frontend

- **Framework**: Next.js 15 with App Router
- **UI Library**: React 19
- **Styling**: Tailwind CSS v4 with OKLCH colors
- **Components**: shadcn/ui + Radix UI primitives
- **State Management**: Zustand (global), TanStack Query (server state)
- **Code Editor**: CodeMirror 6
- **Real-time**: WebSocket client

### Backend

- **API Framework**: Hono (lightweight Node.js framework)
- **Runtime**: Node.js 20+ with tsx
- **Database**: PostgreSQL 15+ with Prisma ORM
- **Authentication**: Better Auth (OAuth, 2FA, Passkeys)
- **WebSocket**: @hono/node-ws
- **Validation**: Zod

### Daemon

- **Language**: Rust (Edition 2021)
- **Web Framework**: Axum
- **Docker API**: Bollard
- **Async Runtime**: Tokio
- **SFTP**: russh
- **Scheduling**: tokio-cron-scheduler

### Infrastructure

- **Monorepo**: Turborepo with pnpm workspaces
- **Database**: PostgreSQL with Row-Level Security
- **Cache**: Redis 7
- **Containerization**: Docker + Docker Compose

## Data Flow

### Server Creation

<Steps>
  <Step title="1. User Request">
    User clicks "Create Server" in web panel
  </Step>

  <Step title="2. API Validation">
    - Validates user permissions
    - Checks resource availability
    - Creates database record
  </Step>

  <Step title="3. Daemon Communication">
    API sends create request to daemon
  </Step>

  <Step title="4. Container Setup">
    Daemon pulls image and creates container with limits
  </Step>

  <Step title="5. Real-time Updates">
    WebSocket sends status to web panel
  </Step>
</Steps>

### Console Access

Real-time console updates flow:

1. Web panel connects to API via WebSocket
2. API forwards connection to daemon
3. Daemon attaches to container logs
4. Logs stream back through daemon → API → Web panel

## Authentication & Security

### Authentication Methods

- Email/password with bcrypt
- OAuth (Google, GitHub, Discord)
- Two-factor authentication (TOTP)
- Passkeys (WebAuthn)

### Authorization

- 45+ granular permissions
- PostgreSQL Row-Level Security
- API keys for programmatic access
- Rate limiting on all endpoints

### Network Security

- TLS 1.3 in production
- CORS configuration per environment
- CSRF token protection
- Input validation with Zod

## Deployment Architecture

### Development

```
Docker Compose
├── Web (3000)
├── API (3001)
├── PostgreSQL
├── Redis
└── Home (3002)
```

### Production

```
Load Balancer
├── API Server instances
│   └── PostgreSQL
├── Web CDN/Server
└── Daemon Nodes
    ├── Game Server Containers
    └── Local Storage
```

## Performance Considerations

### Frontend Optimization

- Static generation for pages
- Route-based code splitting
- Image optimization
- Client-side caching with SWR

### Backend Optimization

- Database connection pooling
- Redis caching layer
- Query optimization with indexes
- WebSocket connection reuse

### Scaling

- Horizontal API server scaling
- Multiple daemon nodes
- Database read replicas
- Redis cluster for cache

## Monitoring & Observability

The system provides:

- Structured logging
- Performance metrics
- Error tracking (Sentry optional)
- Resource monitoring per server
- WebSocket connection tracking

## Security Model

### Data Protection

- Encrypted at rest (application level)
- Encrypted in transit (TLS)
- Database encryption optional
- Backup encryption supported

### Access Control

- User-based permissions
- Server-based permissions
- IP whitelisting available
- API key rate limiting

## API Design

RESTful API with:

- Standard HTTP status codes
- JSON request/response format
- Pagination support
- Filter and sort capabilities
- Comprehensive error handling

Example endpoints:

```
GET    /api/servers
POST   /api/servers
GET    /api/servers/:id
PATCH  /api/servers/:id
DELETE /api/servers/:id
POST   /api/servers/:id/start
POST   /api/servers/:id/stop
```

## Database Schema

Key entities:

- **Users** - User accounts with roles
- **Servers** - Game server instances
- **Blueprints** - Server templates
- **Nodes** - Physical compute nodes
- **Backups** - Server backups
- **Files** - Server file records
- **Permissions** - User permissions

All protected with Row-Level Security policies.

## Extensibility

StellarStack is designed for extensibility:

- Plugin system (planned)
- Custom blueprints
- Webhook events
- API for integrations
- Theme customization

## Future Architecture

Planned improvements:

- Kubernetes support
- Multi-region federation
- Advanced monitoring
- Machine learning for optimization
- Event-driven architecture

## Next Steps

<CardGroup cols={2}>
  <Card title="API Reference" icon="code" href="/api-reference/introduction">
    Explore the API
  </Card>
  <Card title="Development Setup" icon="code" href="/guides/development">
    Set up for development
  </Card>
  <Card title="Contributing" icon="github" href="/contributing">
    Contribute to StellarStack
  </Card>
</CardGroup>

<Info>
  For detailed questions about architecture, join our [Discord community](https://discord.gg/stellarstack).
</Info>
